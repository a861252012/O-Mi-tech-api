/*! cross - v0.1.2 - 2018-02-05 */function replaceOldRoomLink(){var a=location.pathname,b=a.match(/(\d+)/)[0];$("#oldRoom").attr("href","/"+b)}function checkSafeEmail(){var a=window.SAFE_MAIL_STATE,b="<div class='mail-check-live'><table class='needCheck'><tbody><tr ><td colspan='2'>安全访问条件:</td></tr><tr class='mail-check-status'><td>邮箱验证</td><td class='needCheck-item '><span class='needCheck-item-yes' >是</span></td></tr><tr><td>账户余额</td><td class='needCheck-item'>"+a.in_limit_points+"钻</td></tr></tbody></table><table class='nowCheck'><tbody><tr><td colspan='2'>您的当前状态:</td></tr><tr class='mail-check-status'><td>邮箱验证</td><td class='needCheck-item nowCheck-item'></td></tr><tr><td>账户余额</td><td class='needCheck-item'>"+a.points+"钻</td></tr></tbody></table><div class='mail-check-live-level'><span></span><span>当前账号安全级别:</span><span class='mail-check-live-level-text'></span><div class='p-bar'><span class='progress'></span></div></div><div class='mail-warn'>账号提醒：您的账户<span class='mail-warn-points'>低于"+a.in_limit_points+"钻,</span>存在安全危机，请充值或验证邮箱提高账户安全度</div></div>",c=$.dialog({title:"账号安全提醒",content:b,okValue:"验证邮箱",closeButtonDisplay:!0,ok:function(){location.href="/mailverific"},cancelValue:"充值",cancel:function(){showPay()}});""===a.roled?c.remove():c.show(),""===a.safemail?$(".nowCheck-item").html("否"):$(".nowCheck-item").html("是");var d=0,e=parseInt(a.in_limit_points),f=parseInt(a.points);switch("0"===a.in_limit_safemail?($(".mail-check-status").remove(),e>f?($(".mail-warn-points").show(),d=0):d=2):e>f?($(".mail-warn-points").show(),d=""===a.safemail?0:1):""===a.safemail?(d=1,"0"===a.new_user?setTimeout(function(){c.remove()},1e4):c.show()):d=2,d){case 0:$(".progress").addClass("progress-l"),$(".mail-check-live-level-text").html("低").css("color","red");break;case 1:$(".progress").addClass("progress-m"),$(".mail-check-live-level-text").html("中").css("color","#ECB43A");break;default:c.remove()}}function getRid(){var a,b,c=window.location.href.replace(/[><'"]/g,""),d=c.substring(c.indexOf("?")+1,c.length).split("&"),e={};for(a=0;b=d[a];a++)e[b.substring(0,b.indexOf("=")).toLowerCase()]=b.substring(b.indexOf("=")+1,b.length);var f=e.rid;return"undefined"==typeof f?"":f}function getUserKey(){var a=window.document.cookie,b="";if(void 0!=a)for(var c=a.split(";"),d=0;d<c.length;d++){var e=c[d],f=e.indexOf("=");if(f>-1){var g=e.substring(0,f);g=g.replace(/^\s+|\s+$/g,"");var h=e.substring(f+1);h=h.replace(/^\s+|\s+$/g,""),"PHPSESSID"==g&&(b=h)}}return b}function getRoomKey(){var a=window.document.cookie,b="";if(void 0!=a)for(var c=a.split(";"),d=0;d<c.length;d++){var e=c[d],f=e.indexOf("=");if(f>-1){var g=e.substring(0,f);g=g.replace(/^\s+|\s+$/g,"");var h=e.substring(f+1);h=h.replace(/^\s+|\s+$/g,"").replace(/\"/g,""),"room_host"==g&&(b=h)}}return b}function getSWF(a){return navigator.appName.indexOf("Microsoft")!=-1?window[a]:document[a]}function showUserCenter(){$.isEmptyObject(window.OpenAPI.link)?window.open(gserver+"/member/index","_blank"):window.open(window.OpenAPI.link.usercenter,"_blank")}function gohall(){$.isEmptyObject(window.OpenAPI.link)?window.open(gserver+"/","_blank"):window.open(window.OpenAPI.link.hall,"_blank")}function gomarket(){$.isEmptyObject(window.OpenAPI.link)?window.open(gserver+"/shop","_blank"):window.open(window.OpenAPI.link.shop,"_blank")}function uattention(){window.open(gserver+"/member/attention","_blank")}function uprops(){window.open(gserver+"/member/scene","_blank")}function uconsRecords(){window.open(gserver+"/member/consumerd","_blank")}function userMsg(){window.open(gserver+"/member/msglist/2","_blank")}function systemMsg(){$.isEmptyObject(window.OpenAPI.link)?window.open(gserver+"/member/msglist/1","_blank"):window.open(window.OpenAPI.link.msg,"_blank")}function showPay(){$.isEmptyObject(window.OpenAPI.link)?window.open(gserver+"/charge/order","_blank"):window.open(window.OpenAPI.link.pay,"_blank")}function showReg(){User.showRegDialog()}function showLogin(){User.showLoginDialog()}function showLogout(){window.location.href=gserver+"/logout"}function gotoRoom(a){window.top.location.href=window._flashVars.httpDomain+"/"+a}function reportVideo(a){alert("已经举报了")}!function(a,b){var c=["<div class='noble-d-prop'>","<div class='noble-d-prop_left'>","<img src='"+b.CDN_HOST+"/flash/"+b.PUBLISH_VERSION+"/image/gift_material/#{gid}.png'/>","</div>","<div class='noble-d-prop_right'>","<h2>#{title}</h2>","<p>获取资格：#{level_title}</p>","<p>获取方式：贵族坐骑，顾名思义是贵族的象征。当你开通#{level_title}后，该坐骑就会随着#{level_title}一起出现。</p>","<p>坐骑描述：#{desc}</p>","</div>","</div>"].join("");a=function(){this.currentGid=30,this.roomId=0,this.init=function(){Noble.initChargeDialog()},this.getCurrentGid=function(){return this.currentGid},this.setCurrentGid=function(a){this.currentGid=a},this.getRoomId=function(){return this.roomId},this.setRoomId=function(a){this.roomId=a},this.init()},$.extend(a,{currentChargeDialog:null,ins:null,getProp:function(a,b){$.ajax({url:"/getvipmount",type:"POST",dataType:"json",data:a,success:function(a){b&&b(a)},error:function(){Utility.log("get vip mount error!")}})},changeNobleData:function(a){if(a=a||[],!a.length){var b=a.permission,c=a.system;a.level_id_icon='<span class="hotListImg basicLevel'+a.level_id+'"></span>';for(var d in c)"keep_level"==d?c[d]=c[d]+"钻":c[d]="gift_level"==d?'<span class="hotListImg basicLevel'+c[d]+'"></span>':c[d]+'<span class="noble-table-diamond"></span>';switch(b.allowvisitroom=0==b.allowvisitroom?"不受限":"限制",b.modnickname.toString()){case"-1":b.modnickname="不受限";break;case"0":b.modnickname="限制";break;default:var e=b.modnickname.split("|"),f="";"month"==e[1]?f="月":"week"==e[1]?f="周":"year"==e[1]&&(f="年"),b.modnickname=e[0]+"次/"+f}switch(b.haswelcome=0==b.haswelcome?"无":"有",b.chatsecond=0==b.chatsecond?"":b.chatsecond+"/次",b.haschateffect=0==b.haschateffect?"无":"有",b.chatlimit.toString()){case"-1":b.chatlimit="不限制";break;case"0":b.chatlimit="禁言";break;default:b.chatlimit=b.chatlimit+"字"}switch(b.hasvipseat=0==b.hasvipseat?"无":"有",b.nochat.toString()){case"1":b.nochat="防止房主";break;case"0":b.nochat="无";break;case"2":b.nochat="防止管理员";break;case"1|2":b.nochat="防止房主、管理员"}switch(b.nochatlimit=0==b.nochatlimit?"无":b.nochatlimit+"普通用户/天",b.avoidout.toString()){case"1":b.avoidout="防房主";break;case"0":b.avoidout="无";break;case"2":b.avoidout="防止管理员";break;case"1|2":b.avoidout="防止房主、管理员"}b.letout=0==b.letout?"无":b.letout+"普通用户/天",b.allowstealth=0==b.allowstealth?"无":"有"}return a},chargeNoble:function(a){var b=this;$.ajax({url:"/openvip",type:"get",dataType:"jsonp",jsonp:"callback",jsonpCallback:"cb",data:a,success:function(a){switch(b.currentChargeDialog.close(),a.code){case 0:b.chargeNoblePreSuccessCB(a),$.tips("贵族开通成功！您现在就可以使用您的专属坐骑啦！",function(){b.chargeNobleSuccessCB(a)});break;case 102:$.dialog({title:"提示",content:"您的钻石不足, 充值即可开通贵族喔!",okValue:"立即充值",ok:function(){location.href="/charge/order"}}).show();break;default:$.tips(a.msg)}},error:function(){Utility.log("charge noble error!"),b.chargeNobleErrorCB()}})},chargeNobleSuccessCB:function(a){},chargeNoblePreSuccessCB:function(a){},chargeNobleErrorCB:function(){},initChargeDialog:function(){var a=this,b=["<div class='noble-d-charge'>","<ul class='noble-d_menu clearfix'></ul>","<div class='noble-d_main'></div>","</div>"].join("");a.currentChargeDialog=$.dialog({title:"开通贵族",content:b,onshow:function(){var b=a.ins.getCurrentGid();a.appendNobleDialogList(b),a.bindNobleSwitchEvent()}})},appendNobleDialogList:function(a){var b=this;b.getNobleAllInfo(function(b){var c="",d=b.info;$.each(d,function(a,b){c=c+"<li class='noble-d_tab' data-gid='"+d[a].gid+"'><span class='hotListImg basicLevel"+d[a].level_id+"'></span></li>"});var e=$(c);e.eq(0).addClass("active"),$(".noble-d_menu").html(e),$(".noble-d_menu").find(".noble-d_tab").filter("[data-gid="+a+"]").trigger("click")})},showChargeDialog:function(){this.currentChargeDialog.show()},getPropInfo:function(a){return{gid:a.data("gid"),title:a.data("title"),level_title:a.data("lvtitle"),desc:a.data("desc")}},showGetPropsDialog:function(a,b){var d=this,e=Utility.template(c,d.getPropInfo(a)),f=$.dialog({title:"贵族专属",content:e,onshow:function(){},ok:function(){f.close(),b&&b()},okValue:"开通贵族身份"}).show()},getNobleInfo:function(a){var b=this;$.ajax({url:"/getgroup",type:"get",dataType:"jsonp",jsonp:"callback",jsonpCallback:"cb",data:{gid:b.ins.getCurrentGid()},success:function(b){0==b.code?a&&b.info&&a(b.info):$.tips(b.msg)},error:function(){Utility.log("get noble group info failure.")}})},getNobleAllInfo:function(a){$.ajax({url:"/getgroupall",type:"get",dataType:"jsonp",jsonp:"callback",jsonpCallback:"cb",data:"",success:function(b){b.code?Utility.log(b.msg):a&&a(b)},error:function(){Utility.log("ajax request error")}})},flushNobleInfo:function(a){a.nobleLink="/noble";var b=["<div class='noble-d-charge_head'>","<h2>"+a.level_name+"</h2>","</div>","<div class='noble-d-charge_content'>","<table>","<tr><td>首开礼包：</td><td>"+a.system.gift_money+"</td><td>改名限制：</td><td>"+a.permission.modnickname+"</td></tr>","<tr><td>坐骑：</td><td>"+a.g_mount.name+"</td><td>房间特效欢迎语：</td><td>"+a.permission.haswelcome+"</td></tr>","<tr><td>贵族标识：</td><td>"+a.level_id_icon+"</td><td>聊天特效：</td><td>"+a.permission.haschateffect+"</td></tr>","<tr><td>房间限制：</td><td>"+a.permission.allowvisitroom+"</td><td>发送文字特权：</td><td>"+a.permission.chatlimit+"</td></tr>","<tr><td>贵宾席位置：</td><td>"+a.permission.hasvipseat+"</td><td>隐身人：</td><td>"+a.permission.allowstealth+"</td></tr>","</table>","<h3>开通价格："+a.system.open_money+"</h3>","<p>次月保级条件：贵族等级有效期内，累计充值达"+a.system.keep_level+"。</p>","</div>","<div class='noble-d-charge_btnbox'>","<button class='noble-d_charge_btn btn btn-center' data-gid='"+a.gid+"'>立即开通贵族</button>","<a href='"+a.nobleLink+"' target='_blank' class='noble-d-link'>了解更多</a>","</div>"].join("");$(".noble-d_main").html(b)},bindNobleSwitchEvent:function(){var a=this;$(".noble-d_menu").on("click",".noble-d_tab",function(){var b=$(this);a.ins.setCurrentGid(b.data("gid")),b.siblings(".noble-d_tab").removeClass("active").end().addClass("active"),a.getNobleInfo(function(b){a.bindNobleDialogEvent(b)})})},bindNobleDialogEvent:function(a){var c=this;a=c.changeNobleData(a),c.flushNobleInfo(a),$(".noble-d_charge_btn").on("click",function(a){$(this).prop("disabled",!0);var d=$(this).data("gid");c.chargeNoble({gid:d,roomId:b.ROOMID}),c.chargeNobleErrorCB=function(){$(this).prop("disabled",!1)}})}}),b.Noble=a}("undefined"!=typeof Noble?Noble:{},window),$(function(){replaceOldRoomLink(),User.handleAfterGetUserInfo=function(){var a=window.User.IMG_URL,b=JSON.parse(window.User.QRCODE_IMG);$("#J_qrCode, #J_menuQrCode").attr("src",a+"/"+b[0].temp_name)},$("#J_smartBannerBig").addClass("smart-banner-shows")});var gserver=window.location.protocol+"//"+window.location.hostname;window.onbeforeunload=function(){getSWF("videoRoom").closeRtmp()};